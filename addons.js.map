{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/addons/gamepad/active.png","webpack:///./src/addons/gamepad/close.svg","webpack:///./src/addons/gamepad/cursor.png","webpack:///./src/addons/gamepad/dot.svg","webpack:///./src/addons/gamepad/style.css","webpack:///./src/addons/gamepad/gamepadlib.js","webpack:///./src/addons/gamepad/userscript.js","webpack:///./src/addons/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","window","console","defaultAxesMappings","type","high","low","deadZone","sensitivity","transformAndCopyMapping","mapping","warn","copy","assign","padWithEmptyMappings","array","length","push","getMovementConfiguration","usedKeys","usesArrows","has","usesWASD","getGamepadId","gamepad","id","index","GamepadData","gamepadLib","this","buttonMappings","getDefaultButtonMappings","map","axesMappings","getDefaultAxisMappings","buttons","hints","importedSettings","alreadyUsedKeys","Set","add","possiblePauseKeys","possibleActionKeys","Array","from","filter","includes","findKey","keys","getSecondaryAction","getPauseKey","getUp","getDown","getRight","getLeft","action1","getPrimaryAction","action2","action3","action4","axes","GamepadLib","EventTarget","super","gamepads","Map","handleConnect","handleDisconnect","update","animationFrame","currentTime","deltaTime","virtualCursor","x","y","maxX","Infinity","minX","maxY","minY","modified","_editor","connectCallbacks","generated","keysPressedThisFrame","oldKeysPressed","mouseDownThisFrame","oldMouseDown","addEventHandlers","addEventListener","removeEventListener","size","Promise","resolve","getHintsLazily","e","ensureHintsGenerated","callback","log","gamepadData","set","requestAnimationFrame","dispatchEvent","CustomEvent","detail","delete","cancelAnimationFrame","pressed","down","Math","abs","action","multiplier","speed","time","max","min","navigator","getGamepads","data","updateButton","axis","dispatchKey","dispatchMouseDown","dispatchMouseMove","Error","browserHasBrokenGamepadAPI","userAgent","setConsole","vm","scaffolding","editingTarget","runtime","once","vmStarted","_steppingInterval","scratchKeyToKey","toLowerCase","charAt","getKeysUsedByProject","allBlocks","getTargetForStage","targets","isOriginal","blocks","result","block","values","_blocks","opcode","parent","fields","KEY_OPTION","parsedOptions","comment","comments","text","findOptionsComment","lineWithMagic","split","find","endsWith","jsonText","substr","parsed","JSON","parse","isArray","parseOptionsComment","renderer","width","_xRight","_xLeft","height","_yTop","_yBottom","canvas","virtualCursorElement","document","createElement","hideCursorTimeout","hidden","className","src","path","_twGetAsset","virtualCursorSetVisible","visible","clearTimeout","body","classList","setTimeout","virtualCursorHide","virtualCursorSetDown","toggle","getCanvasSize","remove","ResizeObserver","canvasWidth","canvasHeight","entries","entry","contentRect","observe","rect","getBoundingClientRect","virtualX","virtualY","postMouseData","rectWidth","rectHeight","postIOData","postKeyboardData","isDown","stageX","CURSOR_SIZE","stageY","style","transform","virtualCursorSetPosition","_overlays","appendChild","ScaffoldingAddons","run","css","stylesheet","textContent","head","addStylesheet"],"mappings":"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","file":"addons.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 543);\n","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAIAAABvrngfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAgSURBVBhXY/z//z8DKmCC0kgAKsQIBhA2FlXEmMXAAAC+2gYLeDM0CAAAAABJRU5ErkJggg==\"","module.exports = \"data:image/svg+xml;base64,PHN2ZyBkYXRhLW5hbWU9IkxheWVyIDEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDcuNDggNy40OCI+PHBhdGggZD0iTTMuNzQgNi40OFYxTTEgMy43NGg1LjQ4IiBzdHlsZT0iZmlsbDpub25lO3N0cm9rZTojZmZmO3N0cm9rZS1saW5lY2FwOnJvdW5kO3N0cm9rZS1saW5lam9pbjpyb3VuZDtzdHJva2Utd2lkdGg6MnB4Ii8+PC9zdmc+Cg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAGCAIAAABvrngfAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsIAAA7CARUoSoAAAAAVSURBVBhXYyAF/AcDCJsJQpEKGBgAjmQF/WBrfi0AAAAASUVORK5CYII=\"","module.exports = \"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiIHZpZXdCb3g9IjAgMCAyLjExNyAyLjExNyI+PGNpcmNsZSBjeD0iMS4wNTgiIGN5PSIxLjA1OCIgcj0iMS4wNTgiIGZpbGw9InJlZCIvPjwvc3ZnPgo=\"","module.exports = \".sa-gamepad-container {\\n  margin-right: 0.2rem;\\n}\\n\\n.sa-gamepad-spacer {\\n  display: flex;\\n  width: 100%;\\n  justify-content: flex-end;\\n}\\n\\n.sa-gamepad-popup-outer {\\n  /* above fullscreen */\\n  z-index: 99999;\\n}\\n.sa-gamepad-popup {\\n  box-sizing: border-box;\\n  width: 700px;\\n  max-height: min(800px, 85vh);\\n  height: 100%;\\n  max-width: 85%;\\n  margin: 50px auto;\\n  display: flex;\\n  flex-direction: column;\\n}\\n.sa-gamepad-popup-content {\\n  background-color: white;\\n  padding: 1.5rem 2.25rem;\\n  height: 100%;\\n  overflow-y: auto;\\n}\\n\\n.sa-gamepad-popup [class*=\\\"modal_header-item-title\\\"] {\\n  margin: 0 -20rem 0 0;\\n}\\n\\n.sa-gamepad-cursor {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n  z-index: 9999;\\n  user-select: none;\\n  pointer-events: none;\\n  will-change: transform;\\n  image-rendering: optimizeSpeed;\\n  image-rendering: crisp-edges;\\n  image-rendering: pixelated;\\n}\\n.sa-gamepad-cursor-down {\\n  filter: invert(100%);\\n}\\n\\n.sa-gamepad-small .sa-gamepad-container[data-editor-mode=\\\"editor\\\"] {\\n  display: none !important;\\n}\\n\\n.sa-gamepad-hide-cursor {\\n  cursor: none;\\n}\\n\\n.sa-gamepad-browser-support-warning {\\n  font-weight: bold;\\n  margin-bottom: 10px;\\n}\\n\\n.sa-gamepad-store-settings {\\n  display: none;\\n}\\n.sa-gamepad-store-settings > input {\\n  margin-right: 4px;\\n}\\n.sa-gamepad-has-controller .sa-gamepad-store-settings {\\n  display: block;\\n}\\n\"","let console = window.console;\n\n/*\nMapping types:\n\ntype: \"key\" maps a button to a keyboard key\nAll key names will be interpreted as a KeyboardEvent.key value (https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values)\nhigh: \"KeyName\" is the name of the key to dispatch when a button reads a HIGH value\nlow: \"KeyName\" is the name of the key to dispatch when a button reads a LOW value\ndeadZone: 0.5 controls the minimum value necessary to be read in either + or - to trigger either high or low\nThe high/low distinction is necessary for axes. Buttons will only use high\n\ntype: \"mousedown\" maps a button to control whether the mouse is down or not\ndeadZone: 0.5 controls the minimum value to trigger a mousedown\n\ntype: \"virtual_cursor\" maps a button to control the \"virtual cursor\"\ndeadZone: 0.5 again controls the minimum value to trigger a movement\nsensitivity: 10 controls the speed\nhigh: \"+y\"/\"-y\"/\"+x\"/\"-x\" defines what happens when an axis reads high\nlow: \"+y\"/\"-y\"/\"+x\"/\"-x\" defines what happens when an axis reads low\n+y increases y, -y decreases y, +x increases x, -x decreases x.\n*/\n\nconst defaultAxesMappings = {\n  arrows: [\n    {\n      type: \"key\",\n      high: \"ArrowRight\",\n      low: \"ArrowLeft\",\n      deadZone: 0.5,\n    },\n    {\n      type: \"key\",\n      high: \"ArrowDown\",\n      low: \"ArrowUp\",\n      deadZone: 0.5,\n    },\n  ],\n  wasd: [\n    {\n      type: \"key\",\n      high: \"d\",\n      low: \"a\",\n      deadZone: 0.5,\n    },\n    {\n      type: \"key\",\n      high: \"s\",\n      low: \"w\",\n      deadZone: 0.5,\n    },\n  ],\n  cursor: [\n    {\n      type: \"virtual_cursor\",\n      high: \"+x\",\n      low: \"-x\",\n      sensitivity: 0.6,\n      deadZone: 0.2,\n    },\n    {\n      type: \"virtual_cursor\",\n      high: \"-y\",\n      low: \"+y\",\n      sensitivity: 0.6,\n      deadZone: 0.2,\n    },\n  ],\n};\n\nconst emptyMapping = () => ({\n  type: \"key\",\n  high: null,\n  low: null,\n});\nconst transformAndCopyMapping = (mapping) => {\n  if (typeof mapping !== \"object\" || !mapping) {\n    console.warn(\"invalid mapping\", mapping);\n    return emptyMapping();\n  }\n  const copy = Object.assign({}, mapping);\n  if (copy.type === \"key\") {\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n    if (typeof copy.high === \"undefined\") {\n      copy.high = \"\";\n    }\n    if (typeof copy.low === \"undefined\") {\n      copy.low = \"\";\n    }\n  } else if (copy.type === \"mousedown\") {\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n  } else if (copy.type === \"virtual_cursor\") {\n    if (typeof copy.high === \"undefined\") {\n      copy.high = \"\";\n    }\n    if (typeof copy.low === \"undefined\") {\n      copy.low = \"\";\n    }\n    if (typeof copy.sensitivity === \"undefined\") {\n      copy.sensitivity = 10;\n    }\n    if (typeof copy.deadZone === \"undefined\") {\n      copy.deadZone = 0.5;\n    }\n  } else {\n    console.warn(\"unknown mapping type\", copy.type);\n    return emptyMapping();\n  }\n  return copy;\n};\nconst prepareMappingForExport = (mapping) => Object.assign({}, mapping);\nconst prepareAxisMappingForExport = prepareMappingForExport;\nconst prepareButtonMappingForExport = (mapping) => {\n  const copy = prepareMappingForExport(mapping);\n  delete copy.deadZone;\n  delete copy.low;\n  return copy;\n};\n\nconst padWithEmptyMappings = (array, length) => {\n  // Keep adding empty mappings until the list is full\n  while (array.length < length) {\n    array.push(emptyMapping());\n  }\n  // In case the input array is longer than the desired length\n  array.length = length;\n  return array;\n};\n\nconst getMovementConfiguration = (usedKeys) => ({\n  usesArrows:\n    usedKeys.has(\"ArrowUp\") || usedKeys.has(\"ArrowDown\") || usedKeys.has(\"ArrowRight\") || usedKeys.has(\"ArrowLeft\"),\n  usesWASD: (usedKeys.has(\"w\") && usedKeys.has(\"s\")) || (usedKeys.has(\"a\") && usedKeys.has(\"d\")),\n});\n\nconst getGamepadId = (gamepad) => `${gamepad.id} (${gamepad.index})`;\n\nclass GamepadData {\n  /**\n   * @param {Gamepad} gamepad Source Gamepad\n   * @param {GamepadLib} gamepadLib Parent GamepadLib\n   */\n  constructor(gamepad, gamepadLib) {\n    this.gamepad = gamepad;\n    this.gamepadLib = gamepadLib;\n    this.buttonMappings = this.getDefaultButtonMappings().map(transformAndCopyMapping);\n    this.axesMappings = this.getDefaultAxisMappings().map(transformAndCopyMapping);\n  }\n\n  getDefaultButtonMappings() {\n    let buttons;\n    if (this.gamepadLib.hints.importedSettings) {\n      buttons = this.gamepadLib.hints.importedSettings.buttons;\n    } else {\n      const usedKeys = this.gamepadLib.hints.usedKeys;\n      const alreadyUsedKeys = new Set();\n      const { usesArrows, usesWASD } = getMovementConfiguration(usedKeys);\n      if (usesWASD) {\n        alreadyUsedKeys.add(\"w\");\n        alreadyUsedKeys.add(\"a\");\n        alreadyUsedKeys.add(\"s\");\n        alreadyUsedKeys.add(\"d\");\n      }\n      const possiblePauseKeys = [\n        // Restart keys, pause keys, other potentially dangerous keys\n        \"p\",\n        \"q\",\n        \"r\",\n      ];\n      const possibleActionKeys = [\n        \" \",\n        \"Enter\",\n        \"e\",\n        \"f\",\n        \"z\",\n        \"x\",\n        \"c\",\n        ...Array.from(usedKeys).filter((i) => i.length === 1 && !possiblePauseKeys.includes(i)),\n      ];\n\n      const findKey = (keys) => {\n        for (const key of keys) {\n          if (usedKeys.has(key) && !alreadyUsedKeys.has(key)) {\n            alreadyUsedKeys.add(key);\n            return key;\n          }\n        }\n        return null;\n      };\n      const getPrimaryAction = () => {\n        if (usesArrows && usedKeys.has(\"ArrowUp\")) {\n          return \"ArrowUp\";\n        }\n        if (usesWASD && usedKeys.has(\"w\")) {\n          return \"w\";\n        }\n        return findKey(possibleActionKeys);\n      };\n      const getSecondaryAction = () => findKey(possibleActionKeys);\n      const getPauseKey = () => findKey(possiblePauseKeys);\n      const getUp = () => {\n        if (usesArrows || !usesWASD) return \"ArrowUp\";\n        return \"w\";\n      };\n      const getDown = () => {\n        if (usesArrows || !usesWASD) return \"ArrowDown\";\n        return \"s\";\n      };\n      const getRight = () => {\n        if (usesArrows || !usesWASD) return \"ArrowRight\";\n        return \"d\";\n      };\n      const getLeft = () => {\n        if (usesArrows || !usesWASD) return \"ArrowLeft\";\n        return \"a\";\n      };\n\n      const action1 = getPrimaryAction();\n      let action2 = getSecondaryAction();\n      let action3 = getSecondaryAction();\n      let action4 = getSecondaryAction();\n      // When only 1 or 2 action keys are detected, bind the other buttons to the same things.\n      if (action1 && !action2 && !action3 && !action4) {\n        action2 = action1;\n        action3 = action1;\n        action4 = action1;\n      }\n      if (action1 && action2 && !action3 && !action4) {\n        action3 = action1;\n        action4 = action2;\n      }\n\n      // Set indices \"manually\" because we don't evaluate them in order.\n      buttons = [];\n      buttons[0] = {\n        /*\n        Xbox: A\n        SNES-like: B\n        */\n        type: \"key\",\n        high: action1,\n      };\n      buttons[1] = {\n        /*\n        Xbox: B\n        SNES-like: A\n        */\n        type: \"key\",\n        high: action2,\n      };\n      buttons[2] = {\n        /*\n        Xbox: X\n        SNES-like: Y\n        */\n        type: \"key\",\n        high: action3,\n      };\n      buttons[3] = {\n        /*\n        Xbox: Y\n        SNES-like: X\n        */\n        type: \"key\",\n        high: action4,\n      };\n      buttons[4] = {\n        /*\n        Xbox: LB\n        SNES-like: Left trigger\n        */\n        type: \"mousedown\",\n      };\n      buttons[5] = {\n        /*\n        Xbox: RB\n        */\n        type: \"mousedown\",\n      };\n      buttons[6] = {\n        /*\n        Xbox: LT\n        */\n        type: \"mousedown\",\n      };\n      buttons[7] = {\n        /*\n        Xbox: RT\n        SNES-like: Right trigger\n        */\n        type: \"mousedown\",\n      };\n      buttons[9] = {\n        /*\n        Xbox: Menu\n        SNES-like: Start\n        */\n        type: \"key\",\n        high: getPauseKey(),\n      };\n      buttons[8] = {\n        /*\n        Xbox: Change view\n        SNES-like: Select\n        */\n        type: \"key\",\n        high: getPauseKey(),\n      };\n      // Xbox: Left analog press\n      buttons[10] = emptyMapping();\n      // Xbox: Right analog press\n      buttons[11] = emptyMapping();\n      buttons[12] = {\n        /*\n        Xbox: D-pad up\n        */\n        type: \"key\",\n        high: getUp(),\n      };\n      buttons[13] = {\n        /*\n        Xbox: D-pad down\n        */\n        type: \"key\",\n        high: getDown(),\n      };\n      buttons[14] = {\n        /*\n        Xbox: D-pad left\n        */\n        type: \"key\",\n        high: getLeft(),\n      };\n      buttons[15] = {\n        /*\n        Xbox: D-pad right\n        */\n        type: \"key\",\n        high: getRight(),\n      };\n    }\n    return padWithEmptyMappings(buttons, this.gamepad.buttons.length);\n  }\n\n  getDefaultAxisMappings() {\n    let axes = [];\n    if (this.gamepadLib.hints.importedSettings) {\n      axes = this.gamepadLib.hints.importedSettings.axes;\n    } else {\n      // Only return default axis mappings when there are 4 axes, like an xbox controller\n      // If there isn't exactly 4, we can't really predict what the axes mean\n      // Some controllers map the dpad to *both* buttons and axes at the same time, which would cause conflicts.\n      if (this.gamepad.axes.length === 4) {\n        const usedKeys = this.gamepadLib.hints.usedKeys;\n        const { usesArrows, usesWASD } = getMovementConfiguration(usedKeys);\n        if (usesWASD) {\n          axes.push(defaultAxesMappings.wasd[0]);\n          axes.push(defaultAxesMappings.wasd[1]);\n        } else if (usesArrows) {\n          axes.push(defaultAxesMappings.arrows[0]);\n          axes.push(defaultAxesMappings.arrows[1]);\n        } else {\n          axes.push(defaultAxesMappings.cursor[0]);\n          axes.push(defaultAxesMappings.cursor[1]);\n        }\n        axes.push(defaultAxesMappings.cursor[0]);\n        axes.push(defaultAxesMappings.cursor[1]);\n      }\n    }\n    return padWithEmptyMappings(axes, this.gamepad.axes.length);\n  }\n}\n\nclass GamepadLib extends EventTarget {\n  constructor() {\n    super();\n\n    /** @type {Map<string, GamepadData>} */\n    this.gamepads = new Map();\n\n    this.handleConnect = this.handleConnect.bind(this);\n    this.handleDisconnect = this.handleDisconnect.bind(this);\n    this.update = this.update.bind(this);\n\n    this.animationFrame = null;\n    this.currentTime = null;\n    this.deltaTime = 0;\n\n    this.virtualCursor = {\n      x: 0,\n      y: 0,\n      maxX: Infinity,\n      minX: -Infinity,\n      maxY: Infinity,\n      minY: -Infinity,\n      modified: false,\n    };\n\n    this._editor = null;\n\n    this.connectCallbacks = [];\n\n    this.hints = {\n      usedKeys: new Set(),\n      importedSettings: null,\n      generated: false,\n    };\n\n    this.keysPressedThisFrame = new Set();\n    this.oldKeysPressed = new Set();\n\n    this.mouseDownThisFrame = false;\n    this.oldMouseDown = false;\n\n    this.addEventHandlers();\n  }\n\n  addEventHandlers() {\n    window.addEventListener(\"gamepadconnected\", this.handleConnect);\n    window.addEventListener(\"gamepaddisconnected\", this.handleDisconnect);\n  }\n\n  removeEventHandlers() {\n    window.removeEventListener(\"gamepadconnected\", this.handleConnect);\n    window.removeEventListener(\"gamepaddisconnected\", this.handleDisconnect);\n  }\n\n  gamepadConnected() {\n    if (this.gamepads.size > 0) {\n      return Promise.resolve();\n    }\n    return new Promise((resolve) => {\n      this.connectCallbacks.push(resolve);\n    });\n  }\n\n  ensureHintsGenerated() {\n    if (this.hints.generated) {\n      return;\n    }\n    if (this.getHintsLazily) {\n      Object.assign(this.hints, this.getHintsLazily());\n    }\n    this.hints.generated = true;\n  }\n\n  handleConnect(e) {\n    this.ensureHintsGenerated();\n    for (const callback of this.connectCallbacks) {\n      callback();\n    }\n    this.connectCallbacks = [];\n    const gamepad = e.gamepad;\n    const id = getGamepadId(gamepad);\n    console.log(\"connected\", gamepad);\n    const gamepadData = new GamepadData(gamepad, this);\n    this.gamepads.set(id, gamepadData);\n    if (this.animationFrame === null) {\n      this.animationFrame = requestAnimationFrame(this.update);\n    }\n    this.dispatchEvent(new CustomEvent(\"gamepadconnected\", { detail: gamepadData }));\n  }\n\n  handleDisconnect(e) {\n    const gamepad = e.gamepad;\n    const id = getGamepadId(gamepad);\n    console.log(\"disconnected\", gamepad);\n    const gamepadData = this.gamepads.get(id);\n    this.gamepads.delete(id);\n    this.dispatchEvent(new CustomEvent(\"gamepaddisconnected\", { detail: gamepadData }));\n    if (this.gamepads.size === 0) {\n      cancelAnimationFrame(this.animationFrame);\n      this.animationFrame = null;\n      this.currentTime = null;\n    }\n  }\n\n  dispatchKey(key, pressed) {\n    if (pressed) {\n      this.dispatchEvent(new CustomEvent(\"keydown\", { detail: key }));\n    } else {\n      this.dispatchEvent(new CustomEvent(\"keyup\", { detail: key }));\n    }\n  }\n\n  dispatchMouseDown(down) {\n    if (down) {\n      this.dispatchEvent(new CustomEvent(\"mousedown\"));\n    } else {\n      this.dispatchEvent(new CustomEvent(\"mouseup\"));\n    }\n  }\n\n  dispatchMouseMove(x, y) {\n    this.dispatchEvent(new CustomEvent(\"mousemove\", { detail: { x, y } }));\n  }\n\n  updateButton(value, mapping) {\n    if (mapping.type === \"key\") {\n      if (value >= mapping.deadZone) {\n        if (mapping.high) {\n          this.keysPressedThisFrame.add(mapping.high);\n        }\n      } else if (value <= -mapping.deadZone) {\n        if (mapping.low) {\n          this.keysPressedThisFrame.add(mapping.low);\n        }\n      }\n    } else if (mapping.type === \"mousedown\") {\n      const isDown = Math.abs(value) >= mapping.deadZone;\n      if (isDown) {\n        this.mouseDownThisFrame = true;\n      }\n    } else if (mapping.type === \"virtual_cursor\") {\n      const deadZone = mapping.deadZone;\n      let action;\n      if (value >= deadZone) action = mapping.high;\n      if (value <= -deadZone) action = mapping.low;\n      if (action) {\n        // an axis value just beyond the deadzone should have a multiplier near 0, a high value should have a multiplier of 1\n        const multiplier = (Math.abs(value) - deadZone) / (1 - deadZone);\n        const speed = multiplier * multiplier * mapping.sensitivity * this.deltaTime;\n        if (action === \"+x\") {\n          this.virtualCursor.x += speed;\n        } else if (action === \"-x\") {\n          this.virtualCursor.x -= speed;\n        } else if (action === \"+y\") {\n          this.virtualCursor.y += speed;\n        } else if (action === \"-y\") {\n          this.virtualCursor.y -= speed;\n        }\n        this.virtualCursor.modified = true;\n      }\n    }\n  }\n\n  update(time) {\n    this.oldKeysPressed = this.keysPressedThisFrame;\n    this.oldMouseDown = this.mouseDownThisFrame;\n    this.keysPressedThisFrame = new Set();\n    this.mouseDownThisFrame = false;\n\n    if (this.currentTime === null) {\n      this.deltaTime = 0; // doesn't matter what this is, it's just the first frame\n    } else {\n      this.deltaTime = time - this.currentTime;\n    }\n    this.deltaTime = Math.max(Math.min(this.deltaTime, 1000), 0);\n    this.currentTime = time;\n\n    this.animationFrame = requestAnimationFrame(this.update);\n\n    const gamepads = navigator.getGamepads();\n    for (const gamepad of gamepads) {\n      if (gamepad === null) {\n        continue;\n      }\n\n      const id = getGamepadId(gamepad);\n      const data = this.gamepads.get(id);\n\n      for (let i = 0; i < gamepad.buttons.length; i++) {\n        const button = gamepad.buttons[i];\n        const value = button.value;\n        const mapping = data.buttonMappings[i];\n        this.updateButton(value, mapping);\n      }\n\n      for (let i = 0; i < gamepad.axes.length; i++) {\n        const axis = gamepad.axes[i];\n        const mapping = data.axesMappings[i];\n        this.updateButton(axis, mapping);\n      }\n    }\n\n    if (this._editor) {\n      this._editor.update(gamepads);\n    }\n\n    for (const key of this.keysPressedThisFrame) {\n      if (!this.oldKeysPressed.has(key)) {\n        this.dispatchKey(key, true);\n      }\n    }\n    for (const key of this.oldKeysPressed) {\n      if (!this.keysPressedThisFrame.has(key)) {\n        this.dispatchKey(key, false);\n      }\n    }\n    if (this.mouseDownThisFrame && !this.oldMouseDown) {\n      this.dispatchMouseDown(true);\n    } else if (!this.mouseDownThisFrame && this.oldMouseDown) {\n      this.dispatchMouseDown(false);\n    }\n    if (this.virtualCursor.modified) {\n      this.virtualCursor.modified = false;\n      if (this.virtualCursor.x > this.virtualCursor.maxX) {\n        this.virtualCursor.x = this.virtualCursor.maxX;\n      }\n      if (this.virtualCursor.x < this.virtualCursor.minX) {\n        this.virtualCursor.x = this.virtualCursor.minX;\n      }\n      if (this.virtualCursor.y > this.virtualCursor.maxY) {\n        this.virtualCursor.y = this.virtualCursor.maxY;\n      }\n      if (this.virtualCursor.y < this.virtualCursor.minY) {\n        this.virtualCursor.y = this.virtualCursor.minY;\n      }\n      this.dispatchMouseMove(this.virtualCursor.x, this.virtualCursor.y);\n    }\n  }\n\n  editor() {\n    throw new Error('removed');\n  }\n}\n\nGamepadLib.browserHasBrokenGamepadAPI = () => {\n  // Check that the gamepad API is supported at all\n  if (!navigator.getGamepads) {\n    return true;\n  }\n  // Firefox on Linux has a broken gamepad API implementation that results in strange and sometimes unusable mappings\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1643358\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=1643835\n  if (navigator.userAgent.includes(\"Firefox\") && navigator.userAgent.includes(\"Linux\")) {\n    return true;\n  }\n  // Firefox on macOS has other bugs that result in strange and unusable mappings\n  // eg. https://bugzilla.mozilla.org/show_bug.cgi?id=1434408\n  if (navigator.userAgent.includes(\"Firefox\") && navigator.userAgent.includes(\"Mac OS\")) {\n    return true;\n  }\n  return false;\n};\n\nGamepadLib.setConsole = (n) => (console = n);\n\nexport default GamepadLib;\n","/* inserted by pull.js */\nimport _twAsset0 from \"./active.png\";\nimport _twAsset1 from \"./close.svg\";\nimport _twAsset2 from \"./cursor.png\";\nimport _twAsset3 from \"./dot.svg\";\nconst _twGetAsset = (path) => {\n  if (path === \"/active.png\") return _twAsset0;\n  if (path === \"/close.svg\") return _twAsset1;\n  if (path === \"/cursor.png\") return _twAsset2;\n  if (path === \"/dot.svg\") return _twAsset3;\n  throw new Error(`Unknown asset: ${path}`);\n};\n\nimport GamepadLib from \"./gamepadlib.js\";\n\nexport default async function (scaffolding) {\n  const vm = scaffolding.vm;\n\n  // Wait for the project to finish loading. Renderer and scripts will not be fully available until this happens.\n  await new Promise((resolve) => {\n    if (vm.editingTarget) return resolve();\n    vm.runtime.once(\"PROJECT_LOADED\", resolve);\n  });\n\n  const vmStarted = () => vm.runtime._steppingInterval !== null;\n\n  const scratchKeyToKey = (key) => {\n    switch (key) {\n      case \"right arrow\":\n        return \"ArrowRight\";\n      case \"up arrow\":\n        return \"ArrowUp\";\n      case \"left arrow\":\n        return \"ArrowLeft\";\n      case \"down arrow\":\n        return \"ArrowDown\";\n      case \"enter\":\n        return \"Enter\";\n      case \"space\":\n        return \" \";\n    }\n    return key.toLowerCase().charAt(0);\n  };\n  const getKeysUsedByProject = () => {\n    const allBlocks = [vm.runtime.getTargetForStage(), ...vm.runtime.targets]\n      .filter((i) => i.isOriginal)\n      .map((i) => i.blocks);\n    const result = new Set();\n    for (const blocks of allBlocks) {\n      for (const block of Object.values(blocks._blocks)) {\n        if (block.opcode === \"event_whenkeypressed\" || block.opcode === \"sensing_keyoptions\") {\n          // For blocks like \"key (my variable) pressed?\", the sensing_keyoptions still exists but has a null parent.\n          if (block.opcode === \"sensing_keyoptions\" && !block.parent) {\n            continue;\n          }\n          const key = block.fields.KEY_OPTION.value;\n          result.add(scratchKeyToKey(key));\n        }\n      }\n    }\n    return result;\n  };\n\n  const GAMEPAD_CONFIG_MAGIC = \" // _gamepad_\";\n  const findOptionsComment = () => {\n    const target = vm.runtime.getTargetForStage();\n    const comments = target.comments;\n    for (const comment of Object.values(comments)) {\n      if (comment.text.includes(GAMEPAD_CONFIG_MAGIC)) {\n        return comment;\n      }\n    }\n    return null;\n  };\n  const parseOptionsComment = () => {\n    const comment = findOptionsComment();\n    if (!comment) {\n      return null;\n    }\n    const lineWithMagic = comment.text.split(\"\\n\").find((i) => i.endsWith(GAMEPAD_CONFIG_MAGIC));\n    if (!lineWithMagic) {\n      console.warn(\"Gamepad comment does not contain valid line\");\n      return null;\n    }\n    const jsonText = lineWithMagic.substr(0, lineWithMagic.length - GAMEPAD_CONFIG_MAGIC.length);\n    let parsed;\n    try {\n      parsed = JSON.parse(jsonText);\n      if (!parsed || typeof parsed !== \"object\" || !Array.isArray(parsed.buttons) || !Array.isArray(parsed.axes)) {\n        throw new Error(\"Invalid data\");\n      }\n    } catch (e) {\n      console.warn(\"Gamepad comment has invalid JSON\", e);\n      return null;\n    }\n    return parsed;\n  };\n\n  GamepadLib.setConsole(console);\n  const gamepad = new GamepadLib();\n\n  const parsedOptions = parseOptionsComment();\n  gamepad.getHintsLazily = () => {\n    if (parsedOptions) {\n      return {\n        importedSettings: parsedOptions,\n      };\n    }\n    return {\n      usedKeys: getKeysUsedByProject(),\n    };\n  };\n\n  const renderer = vm.runtime.renderer;\n  const width = renderer._xRight - renderer._xLeft;\n  const height = renderer._yTop - renderer._yBottom;\n  const canvas = renderer.canvas;\n\n  const virtualCursorElement = document.createElement(\"img\");\n  virtualCursorElement.hidden = true;\n  virtualCursorElement.className = \"sa-gamepad-cursor\";\n  virtualCursorElement.src = _twGetAsset(\"/cursor.png\");\n\n  let hideCursorTimeout;\n\n  const hideRealCursor = () => {\n    document.body.classList.add(\"sa-gamepad-hide-cursor\");\n  };\n  const showRealCursor = () => {\n    document.body.classList.remove(\"sa-gamepad-hide-cursor\");\n  };\n  const virtualCursorSetVisible = (visible) => {\n    virtualCursorElement.hidden = !visible;\n    clearTimeout(hideCursorTimeout);\n    if (visible) {\n      hideRealCursor();\n      hideCursorTimeout = setTimeout(virtualCursorHide, 8000);\n    }\n  };\n  const virtualCursorHide = () => {\n    virtualCursorSetVisible(false);\n  };\n  const virtualCursorSetDown = (down) => {\n    virtualCursorSetVisible(true);\n    virtualCursorElement.classList.toggle(\"sa-gamepad-cursor-down\", down);\n  };\n  const virtualCursorSetPosition = (x, y) => {\n    virtualCursorSetVisible(true);\n    const CURSOR_SIZE = 6;\n    const stageX = width / 2 + x - CURSOR_SIZE / 2;\n    const stageY = height / 2 - y - CURSOR_SIZE / 2;\n    virtualCursorElement.style.transform = `translate(${stageX}px, ${stageY}px)`;\n  };\n\n  document.addEventListener(\"mousemove\", () => {\n    virtualCursorSetVisible(false);\n    showRealCursor();\n  });\n\n  let getCanvasSize;\n  // Support modern ResizeObserver and slow getBoundingClientRect version for improved browser support (matters for TurboWarp)\n  if (window.ResizeObserver) {\n    let canvasWidth = width;\n    let canvasHeight = height;\n    const resizeObserver = new ResizeObserver((entries) => {\n      for (const entry of entries) {\n        canvasWidth = entry.contentRect.width;\n        canvasHeight = entry.contentRect.height;\n      }\n    });\n    resizeObserver.observe(canvas);\n    getCanvasSize = () => [canvasWidth, canvasHeight];\n  } else {\n    getCanvasSize = () => {\n      const rect = canvas.getBoundingClientRect();\n      return [rect.width, rect.height];\n    };\n  }\n\n  // Both in Scratch space\n  let virtualX = 0;\n  let virtualY = 0;\n  const postMouseData = (data) => {\n    if (!vmStarted()) return;\n    const [rectWidth, rectHeight] = getCanvasSize();\n    vm.postIOData(\"mouse\", {\n      ...data,\n      canvasWidth: rectWidth,\n      canvasHeight: rectHeight,\n      x: (virtualX + width / 2) * (rectWidth / width),\n      y: (height / 2 - virtualY) * (rectHeight / height),\n    });\n  };\n  const postKeyboardData = (key, isDown) => {\n    if (!vmStarted()) return;\n    vm.postIOData(\"keyboard\", {\n      key,\n      isDown,\n    });\n  };\n  const handleGamepadButtonDown = (e) => postKeyboardData(e.detail, true);\n  const handleGamepadButtonUp = (e) => postKeyboardData(e.detail, false);\n  const handleGamepadMouseDown = () => {\n    virtualCursorSetDown(true);\n    postMouseData({\n      isDown: true,\n    });\n  };\n  const handleGamepadMouseUp = () => {\n    virtualCursorSetDown(false);\n    postMouseData({\n      isDown: false,\n    });\n  };\n  const handleGamepadMouseMove = (e) => {\n    virtualX = e.detail.x;\n    virtualY = e.detail.y;\n    virtualCursorSetPosition(virtualX, virtualY);\n    postMouseData({});\n  };\n\n  gamepad.virtualCursor.maxX = renderer._xRight;\n  gamepad.virtualCursor.minX = renderer._xLeft;\n  gamepad.virtualCursor.maxY = renderer._yTop;\n  gamepad.virtualCursor.minY = renderer._yBottom;\n  gamepad.addEventListener(\"keydown\", handleGamepadButtonDown);\n  gamepad.addEventListener(\"keyup\", handleGamepadButtonUp);\n  gamepad.addEventListener(\"mousedown\", handleGamepadMouseDown);\n  gamepad.addEventListener(\"mouseup\", handleGamepadMouseUp);\n  gamepad.addEventListener(\"mousemove\", handleGamepadMouseMove);\n\n  scaffolding._overlays.appendChild(virtualCursorElement);\n}\n","import gamepadUserscript from './gamepad/userscript.js';\nimport gamepadUserstyle from '!raw-loader!./gamepad/style.css'\n\nconst addStylesheet = (css) => {\n  const stylesheet = document.createElement('style');\n  stylesheet.textContent = css;\n  document.head.appendChild(stylesheet);\n};\n\nconst run = (scaffolding) => {\n  gamepadUserscript(scaffolding);\n  addStylesheet(gamepadUserstyle);\n};\n\nwindow.ScaffoldingAddons = {\n  run\n};\n"],"sourceRoot":""}